This code was primarily written by Denis Merigoux (INRIA).